<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>✦ Introduction to Fractals ✦</title>
<style>
  :root{
    --accent: #ffffff;
    --dark-trans: rgba(0,0,0,0.72);
    --color-primary: oklch(74% 0.15 32);
    --color-secondary: oklch(65% 0.13 210);
    --color-ui: oklch(65% 0.05 210);

    --color-yellow: oklch(80% 0.16 85);
    --color-green: oklch(60% 0.16 135);
    --color-red: oklch(65% 0.18 15);
    --color-green-2: oklch(54% 0.11 164);
    --color-purple: oklch(62% 0.15 318);
    --color-red-2: oklch(57% 0.2 15);
    --font-family-default: 'Times New Roman', Times, Georgia, Garamond, serif;
    --font-family-heading: 'Fraunces', Didot, 'Bodoni MT', 'Noto Serif Display', 'URW Palladio L', P052, Sylfaen, serif;
    --font-family-monospace: 'Nimbus Mono PS', 'Courier New', monospace;
  }

  html, body {
    height:100%;
    margin:0;
    font-family:var(--font-family-default);
    color:black;
    overflow-x: hidden;
  }

  header{
    text-align:center;
    padding:10vh 20vh;
    font-size:2.6rem;
    font-family:var(--font-family-heading);
    color:white;
    text-shadow:0 6px 18px rgba(0,0,0,0.6);
    position: relative;
    z-index: 2;
  }

  .background-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: -1;
  }

  .background-1, .background-2 {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transition: opacity 2s ease;
    background-size: cover;
    background-position: center;
  }

  .background-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: black;
    opacity: 0.5;
    z-index: 0;
    pointer-events: none;
  }

  .bubble-container{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: calc(3vw + 20px);
    justify-content: center;
    align-items: start;
    width: 95%;
    min-height: calc(100vh - 120px);
    padding: 10vh 5vw;
    position: relative;
    z-index: 2;
  }

  .bubble{
    --size: 200px;
    width: var(--size);
    height: var(--size);
    border-radius:50%;
    background: var(--bubble-base);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 0;
    box-shadow:0 12px 26px rgba(0,0,0,0.45),
       inset -5px -5px 15px rgba(0,0,0,0.45),
       inset 5px 5px 15px rgba(25,50,120,0.259);
    cursor: pointer;
    transition: all .35s ease;
    overflow: hidden;
    position: relative;
    animation: blobMorph 10s ease-in-out infinite, bubbleColorShift 10s ease-in-out infinite alternate;
  }

  @keyframes blobMorph{
    0%, 100% {border-radius: 45% 55% 60% 40% / 50% 40% 60% 50%; }
    33% {border-radius: 55% 45% 45% 55% / 60% 50% 40% 50%; }
    66% {border-radius: 40% 60% 50% 50% / 45% 55% 55% 45%; }
  }

  @keyframes bubbleColorShift{
    0% { background: var(--color-red);}
    14.3% { background: var(--color-primary);}
    28.6% { background: var(--color-yellow);}
    42.9% { background: var(--color-green);}
    57.2% { background: var(--color-green-2);}
    71.5% { background: var(--color-secondary);}
    85.8% { background: var(--color-purple);}
    100% { background: var(--color-red-2);}
  }

  .bubble:hover{ transform: scale(1.08); z-index:6; }

  .bubble h3{
    margin: 0;
    color: var(--accent);
    font-size: 1.05rem;
    line-height: 1.05;
    text-align: center;
    position: absolute;
    width: 100%;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    font-family:var(--font-family-heading);
  }

  .full-text{
    display:block;
    width:100%;
    max-height:0;
    opacity:0;
    overflow:auto;
    margin-top:12px;
    transition: max-height .45s ease, opacity .35s ease, transform .35s ease;
    transform: translateY(8px);
    color:#f7f7f7;
    text-align:center;
  }

  .bubble.expanded{
    position: fixed;
    margin: 0 !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 80%;
    height: 70%;
    border-radius:12px !important;
    padding:28px;
    z-index:9999;
    box-shadow:0 30px 80px rgba(0,0,0,0.6);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
  }

  .bubble.expanded h3{
    font-size:1.9rem;
    margin-bottom:12px;
    text-align: center;
    position: static;
    transform: none;
    left: auto;
    top: auto;
    width: 100%;
  }

  .bubble.expanded .full-text{
    max-height:60vh;
    opacity:1;
    transform:translateY(0);
  }
  
  .close-btn{ display:none; position:absolute; top:12px; right:12px; background:#111; color:#fff; border:1px solid rgba(255,255,255,0.06); padding:8px 10px; border-radius:6px; cursor:pointer; z-index:20; font-family:inherit; }
  .close-btn:hover{ background:var(--accent); color:#000; }

  @media (max-width:700px){
    .bubble{ --size:140px; }
    .bubble.expanded{ width:92vw; height:78vh; padding:18px; }
    .bubble.expanded h3{ font-size:1.4rem; }
  }

  .nav{ text-align:center; padding:14px 0 28px; z-index: 2; position: relative;}
  .nav a{
    color:#fff; text-decoration:none; padding:10px 16px; background:rgba(0,0,0,0.55); border-radius:8px;
    transition: background .2s;
  }
  .nav a:hover{ background:var(--accent); color:#000; }

</style>
</head>
<body>

  <div id="background-container" class="background-container">
      <div id="background-1" class="background-1"></div>
      <div id="background-2" class="background-2"></div>
      <div class="background-overlay"></div>
  </div>

  <header>✦ Introduction to Fractals ✦</header>

  <div class="bubble-container" id="bubbleContainer">
      <div class="bubble" aria-expanded="false">
      <button class="close-btn" aria-hidden="true">✕</button>
      <h3>What is a Fractal?</h3>
      <div class="full-text" aria-hidden="true">
        <p>
          A <strong>fractal</strong> is a shape or pattern that repeats its structure at different scales — a property
          called <strong>self-similarity</strong>. Fractals are generated by repeating simple rules and often reveal
          infinite complexity from compact formulas.
        </p>
        <p>
          They can be produced by iterative mathematical functions (like the Mandelbrot iteration) or appear in nature
          where the same branching or roughness patterns repeat at multiple scales.
        </p>
      </div>
    </div>

    <div class="bubble" aria-expanded="false">
      <button class="close-btn" aria-hidden="true">✕</button>
      <h3>Fractals in Nature</h3>
      <div class="full-text" aria-hidden="true">
        <p>Natural examples where fractal patterns appear:</p>
        <ul>
          <li>Trees and plant branching</li>
          <li>Rivers and coastlines (meandering complexity)</li>
          <li>Mountains, clouds and snowflakes</li>
          <li>Seashell patterns and hurricanes</li>
        </ul>
      </div>
    </div>

    <div class="bubble" aria-expanded="false">
      <button class="close-btn" aria-hidden="true">✕</button>
      <h3>Abstract Fractals</h3>
      <div class="full-text" aria-hidden="true">
        <p>
          Abstract fractals are produced by repeating mathematical rules on complex numbers or geometric transforms.
          The Mandelbrot set and Julia sets are canonical examples — you compute an iteration for each point and color
          according to the iteration behavior.
        </p>
        <p>
          Computers allowed these sets to be visualized, producing the iconic "infinite detail" images that popularized fractals.
        </p>
      </div>
    </div>

    <div class="bubble" aria-expanded="false">
      <button class="close-btn" aria-hidden="true">✕</button>
      <h3>Key Characteristics</h3>
      <div class="full-text" aria-hidden="true">
        <ul>
          <li><strong>Self-Similarity</strong> — repeated structure at different scales</li>
          <li><strong>Infinite Detail</strong> — more structure appears as you zoom</li>
          <li><strong>Recursive Generation</strong> — built by iterating rules</li>
          <li><strong>Fractal Dimension</strong> — often non-integer dimension</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="nav">
    <a href="index.html">◀ Home</a>
    &nbsp;&nbsp;
    <a href="history.html">History ➝</a>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.2/velocity.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/trianglify/3.0.0/trianglify.min.js"></script>

  <script>
    (function(){
      const bubbles = Array.from(document.querySelectorAll('.bubble'));
      function collapseAll(){
        bubbles.forEach(b => {
          b.classList.remove('expanded');
          b.setAttribute('aria-expanded','false');
          const txt = b.querySelector('.full-text');
          const cb = b.querySelector('.close-btn');
          if(txt) txt.setAttribute('aria-hidden','true');
          if(cb) cb.setAttribute('aria-hidden','true');
        });
      }
      document.addEventListener('click', e => { if(!e.target.closest('.bubble')) collapseAll(); });
      document.addEventListener('keydown', e => { if(e.key==='Escape') collapseAll(); });

      bubbles.forEach(bubble => {
        const fullText = bubble.querySelector('.full-text');
        const closeBtn = bubble.querySelector('.close-btn');
        bubble.addEventListener('click', ev => {
          ev.stopPropagation();
          if(bubble.classList.contains('expanded')) return;
          collapseAll();
          bubble.classList.add('expanded');
          bubble.setAttribute('aria-expanded','true');
          fullText.setAttribute('aria-hidden','false');
          if(closeBtn) closeBtn.setAttribute('aria-hidden','false');
        });
        if(closeBtn){
          closeBtn.addEventListener('click', ev => {
            ev.stopPropagation();
            bubble.classList.remove('expanded');
            bubble.setAttribute('aria-expanded','false');
            fullText.setAttribute('aria-hidden','true');
            closeBtn.setAttribute('aria-hidden','true');
          });
        }
      });
      collapseAll();
    })();

    // Enhanced Trianglify background with more varied light/dark distribution
    $(document).ready(function(){

      const $bg1 = $('#background-1');
      const $bg2 = $('#background-2');
      let toggle = true;

      // Pure grayscale palettes for background
      const colorPalettes = [
          ["#000000", "#1a1a1a", "#333333", "#4d4d4d", "#666666", "#808080", "#999999", "#b3b3b3", "#cccccc"],
          ["#0f0f0f", "#262626", "#404040", "#595959", "#737373", "#8c8c8c", "#a6a6a6", "#bfbfbf"],
          ["#050505", "#1f1f1f", "#353535", "#4a4a4a", "#5f5f5f", "#757575", "#8a8a8a", "#9f9f9f"],
          ["#0a0a0a", "#222222", "#3a3a3a", "#525252", "#6b6b6b", "#838383", "#9c9c9c", "#b5b5b5"],
          ["#111111", "#2a2a2a", "#434343", "#5c5c5c", "#757575", "#8e8e8e", "#a7a7a7", "#c0c0c0"]
      ];
     
      let paletteIndex = 0;

      function shuffleArray(array) {
          const shuffled = [...array];
          for (let i = shuffled.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
          }
          return shuffled;
      }

      function createPattern() {
          const width = $(window).width();
          const height = $(window).height();

          // Randomly shuffle the color palette to vary light/dark distribution
          const shuffledPalette = shuffleArray(colorPalettes[paletteIndex]);
          
          // Add some random variation to cell size and variance for more organic patterns
          const cellSize = 80 + Math.random() * 120;
          const variance = 0.8 + Math.random() * 1.4;

          // Generate Trianglify pattern with shuffled colors
          return Trianglify({
              width: width,
              height: height,
              cell_size: cellSize,  
              variance: variance,
              x_colors: shuffledPalette,
              y_colors: shuffleArray([...shuffledPalette]) // Also shuffle y_colors for more variation
          });
      }

      function setBackground($el, pattern) {
          const svgEl = pattern.svg(); 
          const serializer = new XMLSerializer();
          const svgString = serializer.serializeToString(svgEl);

          const svgData = encodeURIComponent(svgString);
          $el.css({
              'background-image': 'url("data:image/svg+xml;utf8,' + svgData + '")',
              'background-size': 'cover',
              'opacity': 0.9
          });
      }

      function fadeBackgrounds() {
          const pattern1 = createPattern();
          
          // Create a second pattern with a different palette for more variation
          paletteIndex = (paletteIndex + 1) % colorPalettes.length;
          const pattern2 = createPattern();

          if (toggle) {
              setBackground($bg1, pattern1);
              $bg1.velocity("fadeIn", {duration: 3000});
              $bg2.velocity("fadeOut", {duration: 5000});
          } else {
              setBackground($bg2, pattern2);
              $bg2.velocity("fadeIn", {duration: 3000});
              $bg1.velocity("fadeOut", {duration: 5000});
          }
          toggle = !toggle;

          // Move to next palette for the next iteration
          paletteIndex = (paletteIndex + 1) % colorPalettes.length;
      }

      fadeBackgrounds();

      setInterval(fadeBackgrounds, 7000);

      $(window).resize(function(){
          fadeBackgrounds();
      });
    });
  </script>
</body>
</html>
<!--
3. add footer to history.html
-->